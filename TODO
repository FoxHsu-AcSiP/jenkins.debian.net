About jenkins.debian.net
========================
:Author:           Holger Levsen
:Authorinitials:   holger
:EMail:            holger@layer-acht.org
:Status:           in progress
:lang:             en
:Doctype:          article
:Licence:	   GPLv2


== About jenkins.debian.net

* This is pretty much work in progress, (hopefully) doing something useful since October 15th 2012
* Join #debian-qa on irc.debian.org to report bugs or give other feedback!
* git clone git://git.debian.org/git/users/holger/jenkins.debian.net.git
* (virtual) hardware sponsored by http://www.profitbricks.com

== General ToDo

* get rid of reduncacy in job-cfg/*.yaml and also fix the FIXMEs there
* add documentation for jenkins-job-builder:
** publisher:logparse
** svn:scm
* mail notifications (to where?)
* proper backup (=daily), see bottom of this document for what to backup
* more tests (see below)

=== More minor stuff

* squid has problems with SO_FAIL
* split TODO and about.txt?
** use debian stylesheet for about.html
** use job description to create .txt file to be included in about.txt/TODO?
* proper git repo url, outside users/holger
* only trigger (=really run) jobs if available+used packages have changed (save packages in db and compare)

== More tests to be run

=== Test cd-images:

* start client VMs using the profitbricks API: https://www.profitbricks.com/us/media/docs/PB_PublicAPI_EN.pdf (and dhcp)
* to test (at first) weekly images of amd64 std,kde,lxde+xfce weekly and the first sid-di daily
** http://cdimage.debian.org/cdimage/weekly-builds/amd64/jigdo-cd/
** http://cdimage.debian.org/cdimage/daily-builds/sid_d-i/20121020-1/amd64/
* use jigdo to download those images

=== Test tasks:

----
<h01ger> how do i install a task outside d-i?
<h01ger> what interesting tasks are there?
<jcristau> tasksel install <task>
<daemonkeeper> h01ger:  http://packages.debian.org/source/sid/tasksel
----

(FIXME: tasksel doesn't work like this)

== Installed software that makes jenkins.debian.net run

* jenkins.debian.net runs Debian wheezy.
* FIXME: how jenkins was installed + configured
* needed packages are listed in update_jdn.sh and which will also make sure they are installed
** update_jdn.sh is available in the git repo
* package configuration is kept in git and deployed by update_jdn.sh as well

=== installing jenkins-job-builder
* rebuild python-jenkinsapi from sid for wheezy
* pip install python-jenkins
* git clone https://github.com/openstack-ci/jenkins-job-builder ; cd jenkins-job-builder ; python setup.py install

=== using jenkins-job-builder

* then run 'cd /srv/jenkins/job-cfg ; jenkins-jobs update .' to update jobs
* testing: 'cd /srv/jenkins/job-cfg ; rm test-output/ -r ; mkdir test-output ; jenkins-jobs test . -o test-output/ ; ls test-output/'

== To backup

* /etc/.git 
* /var/lib/jenkins/config.xml as well as its plugins etc
