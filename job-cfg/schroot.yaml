- defaults:
        name: schroot-create
        publishers:
                - email:
                        recipients: jenkins+debian-qa holger@layer-acht.org
        triggers:
                - timed: '{my_time}'
        description: 'schroot "{schroot}" -- creation {do_not_edit}'
        distro: 'sid'
        extra-pkgs: ''
        block-downstream: yes
        builders:
                - shell: '/srv/jenkins/bin/schroot-create.sh {schroot} {distro} {extra_pkgs}'

- defaults:
        name: schroot-upgrade
        publishers:
                - email:
                        recipients: jenkins+debian-qa holger@layer-acht.org
        triggers:
                - timed: '{my_time}'
        description: 'schroot "{schroot}" -- upgrade {do_not_edit}'
        distro: 'sid'
        extra-pkgs: ''
        block-downstream: yes
        builders:
                - shell: 'schroot -u root -c source:jenkins-{schroot} -- apt-get update'
                - shell: 'schroot -u root -c source:jenkins-{schroot} -- apt-get -y -u dist-upgrade'
                - shell: 'schroot -u root -c source:jenkins-{schroot} -- apt-get --purge autoremove'

- job-template:
        defaults: schroot-create
        name: '{schroot}-haskell-create'

- job-template:
        defaults: schroot-upgrade
        name: '{schroot}-haskell-upgrade'

- job-template:
        defaults: schroot-create
        name: '{schroot}-sid-create'

- job-template:
        defaults: schroot-upgrade
        name: '{schroot}-sid-upgrade'

- project:
        name: schroot
        do_not_edit: '<br><br>Job configuration source is <a href="http://anonscm.debian.org/gitweb/?p=qa/jenkins.debian.net.git;a=blob;f=job-cfg/schroot.yaml">schroot.yaml</a>.'
        jobs:
                - '{name}-haskell-create':
                        extra_pkgs: 'cabal-install ghc dctrl-tools patchutils libtext-patch-perl libfile-slurp-perl  libipc-run-perl liblist-moreutils-perl libdpkg-perl'
                        my_time: '0 10 * * 1'
                - '{name}-haskell-upgrade':
                        my_time: '0 11 * * *'

                - '{name}-sid-create':
                        my_time: '0 10 * * 2'
                - '{name}-sid-upgrade':
                        my_time: '0 11 * * *'
