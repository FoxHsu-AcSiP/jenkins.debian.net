
- defaults:
    name: chroot-tests
    description: '{my_description}{do_not_edit}'
    logrotate:
      daysToKeep: 90
      numToKeep: 50
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    builders:
      - shell: '/srv/jenkins/bin/chroot_tester.sh {chroot_tester_params}'
    publishers:
      - logparser:
         rulespath: '/srv/jenkins/logparse/debian.rules'
         unstable_on_warning: 'false'
         fail_on_error: 'false'
    properties:
      - sidebar:
          url: http://jenkins.debian.net/userContent/about.html
          text: About jenkins.debian.net
          icon: /userContent/images/debian-swirl-24x24.png
      - sidebar:
          url: http://www.profitbricks.com
          text: Sponsored by Profitbricks
          icon: /userContent/images/profitbricks-24x24.png

- defaults:
    name: chroot-tests+trigger
    description: '{my_description}{do_not_edit}'
    logrotate:
      daysToKeep: 90
      numToKeep: 50
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    builders:
      - shell: '/srv/jenkins/bin/chroot_tester.sh {chroot_tester_params}'
    publishers:
      - logparser:
         rulespath: '/srv/jenkins/logparse/debian.rules'
         unstable_on_warning: 'false'
         fail_on_error: 'false'
      - trigger:
         project: '{my_trigger}'
    properties:
      - sidebar:
          url: http://jenkins.debian.net/userContent/about.html
          text: About jenkins.debian.net
          icon: /userContent/images/debian-swirl-24x24.png
      - sidebar:
          url: http://www.profitbricks.com
          text: Sponsored by Profitbricks
          icon: /userContent/images/profitbricks-24x24.png

#
# FIXME: trigger-project needs to accept a list of projects.
#

- defaults:
    name: chroot-tests+four-trigger
    description: '{my_description}{do_not_edit}'
    logrotate:
      daysToKeep: 90
      numToKeep: 50
      artifactDaysToKeep: -1
      artifactNumToKeep: -1
    builders:
      - shell: '/srv/jenkins/bin/chroot_tester.sh {chroot_tester_params}'
    publishers:
      - logparser:
         rulespath: '/srv/jenkins/logparse/debian.rules'
         unstable_on_warning: 'false'
         fail_on_error: 'false'
      - trigger:
         project: '{my_1st_trigger}'
      - trigger:
         project: '{my_2nd_trigger}'
      - trigger:
         project: '{my_3rd_trigger}'
      - trigger:
         project: '{my_4th_trigger}'
    properties:
      - sidebar:
          url: http://jenkins.debian.net/userContent/about.html
          text: About jenkins.debian.net
          icon: /userContent/images/debian-swirl-24x24.png
      - sidebar:
          url: http://www.profitbricks.com
          text: Sponsored by Profitbricks
          icon: /userContent/images/profitbricks-24x24.png

- job-template:
    name: '{name}-housekeeping'
    description: '{my_description}{do_not_edit}'
    triggers:
      - timed: "0 5 * * *"
    builders:
      - shell: '/srv/jenkins/bin/housekeeping.sh'
    publishers:
      - logparser:
         rulespath: '/srv/jenkins/logparse/debian.rules'
         unstable_on_warning: 'true'
         fail_on_error: 'true'
      - trigger:
         project: '{my_1st_trigger}'
      - trigger:
         project: '{my_2nd_trigger}'
      - trigger:
         project: '{my_3rd_trigger}'

- job-template:
    defaults: chroot-tests
    name: '{name}-sid_install_gnome'

- job-template:
    defaults: chroot-tests+trigger
    name: '{name}-sid_bootstrap'

- job-template:
    defaults: chroot-tests
    name: '{name}-squeeze_install_gnome_upgrade_to_wheezy'

- job-template:
    defaults: chroot-tests
    name: '{name}-squeeze_install_kde_upgrade_to_wheezy'

- job-template:
    defaults: chroot-tests
    name: '{name}-squeeze_install_lxde_upgrade_to_wheezy'

- job-template:
    defaults: chroot-tests
    name: '{name}-squeeze_install_xfce_upgrade_to_wheezy'

- job-template:
    defaults: chroot-tests+four-trigger
    name: '{name}-squeeze_bootstrap_upgrade_to_wheezy'

- job-template:
    defaults: chroot-tests
    name: '{name}-wheezy_install_gnome'

- job-template:
    defaults: chroot-tests
    name: '{name}-wheezy_install_kde'

- job-template:
    defaults: chroot-tests
    name: '{name}-wheezy_install_lxde'

- job-template:
    defaults: chroot-tests
    name: '{name}-wheezy_install_xfce'

- job-template:
    defaults: chroot-tests+four-trigger
    name: '{name}-wheezy_bootstrap'

- project:
    name: chroot-test
    do_not_edit: '<br><br>Configured by <a href="http://jenkins.debian.net/userContent/about.html">jenkins-job-builder</a>, do not edit this job through the web UI.'
    jobs:

      - '{name}-sid_install_gnome':
         chroot_tester_params: 'sid gnome'
         my_description: 'Debootstrap sid, then install GNOME.'

      - '{name}-sid_bootstrap':
         chroot_tester_params: 'sid'
         my_description: 'Debootstrap sid.'
         my_trigger: 'chroot-test-sid_install_gnome'

      - '{name}-squeeze_install_gnome_upgrade_to_wheezy':
         chroot_tester_params: 'squeeze gnome wheezy'
         my_description: 'Debootstrap squeeze, install GNOME then upgrade to wheezy.'

      - '{name}-squeeze_install_kde_upgrade_to_wheezy':
         chroot_tester_params: 'squeeze kde wheezy'
         my_description: 'Debootstrap squeeze, install KDE then upgrade to wheezy.'

      - '{name}-squeeze_install_lxde_upgrade_to_wheezy':
         chroot_tester_params: 'squeeze lxde wheezy'
         my_description: 'Debootstrap squeeze, install LXDE then upgrade to wheezy.'

      - '{name}-squeeze_install_xfce_upgrade_to_wheezy':
         chroot_tester_params: 'squeeze xfce wheezy'
         my_description: 'Debootstrap squeeze, install KFCE then upgrade to wheezy.'

      - '{name}-squeeze_bootstrap_upgrade_to_wheezy':
         chroot_tester_params: 'squeeze none wheezy'
         my_description: 'Debootstrap squeeze, then upgrade to wheezy.'
         my_1st_trigger: 'chroot-test-squeeze_install_gnome_upgrade_to_wheezy'
         my_2nd_trigger: 'chroot-test-squeeze_install_kde_upgrade_to_wheezy'
         my_3rd_trigger: 'chroot-test-squeeze_install_lxde_upgrade_to_wheezy'
         my_4th_trigger: 'chroot-test-squeeze_install_xfce_upgrade_to_wheezy'

      - '{name}-wheezy_install_gnome':
         chroot_tester_params: 'wheezy gnome'
         my_description: 'Debootstrap wheezy, then install GNOME.'

      - '{name}-wheezy_install_kde':
         chroot_tester_params: 'wheezy kde'
         my_description: 'Debootstrap wheezy, then install KDE.'

      - '{name}-wheezy_install_xfce':
         chroot_tester_params: 'wheezy xfce'
         my_description: 'Debootstrap wheezy, then install XFCE.'

      - '{name}-wheezy_install_lxde':
         chroot_tester_params: 'wheezy lxde'
         my_description: 'Debootstrap wheezy, then install LXDE.'

      - '{name}-wheezy_bootstrap':
         chroot_tester_params: 'wheezy'
         my_description: 'Debootstrap wheezy.'
         my_1st_trigger: 'chroot-test-wheezy_install_gnome'
         my_2nd_trigger: 'chroot-test-wheezy_install_kde'
         my_3rd_trigger: 'chroot-test-wheezy_install_lxde'
         my_4th_trigger: 'chroot-test-wheezy_install_xfce'

      - '{name}-housekeeping':
         my_description: 'Cleanup so that there is a predictable environment.'
         my_1st_trigger: 'chroot-test-sid_bootstrap'
         my_2nd_trigger: 'chroot-test-wheezy_bootstrap'
         my_3rd_trigger: 'chroot-test-squeeze_bootstrap_upgrade_to_wheezy'

